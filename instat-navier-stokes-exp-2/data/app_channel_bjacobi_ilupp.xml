<Param>
    <Application>
        <FlowModel>
            <InflowSpeed>2.25</InflowSpeed><!-- 2.25 -->
            <InflowHeight>0.41</InflowHeight><!-- 0.41 -->
            <InflowWidth>0.41</InflowWidth>
        </FlowModel>
        <Boundary>
            <InflowMaterial>15</InflowMaterial>
            <OutflowMaterial>16</OutflowMaterial>
            <CylinderMaterial>14</CylinderMaterial>
            <WallMaterial>13</WallMaterial>
        </Boundary>
        <UseSUPG>0</UseSUPG>
        <GradStabFactor>0</GradStabFactor>
        <CIP>
            <Active>0</Active>
            <EtaV>5e-2</EtaV>
            <EtaP>1e-1</EtaP>
            <ExpV>1.</ExpV>
            <ExpP>3.</ExpP>
        </CIP>
        <DFGbenchmark>0</DFGbenchmark>
    </Application>
    <OutputPrefix>sol_channel_ilupp</OutputPrefix>
    <Mesh>
        <Implementation>DbView</Implementation>
        <Filename2>test_mesh.inp</Filename2>
        <Filename3>dfg_bench3d_rect2.inp</Filename3>
        <SequentialRefLevel>0</SequentialRefLevel>
        <InitialRefLevel>2</InitialRefLevel>
        <UseBoundaryDomainDescriptor>0</UseBoundaryDomainDescriptor>
        <GhostLayerWidth>1</GhostLayerWidth> <!-- 2 needed for schwarz smoother and CIP-->
        <Scaling>1.</Scaling>
    </Mesh>
    <LinearAlgebra>
        <Platform>CPU</Platform>
        <Implementation>Naive</Implementation>
        <MatrixFormat>CSR</MatrixFormat>
        <UseGhostLA>0</UseGhostLA>  <!-- needed for schwarz smoother, cannot be used for Hypre LA-->
    </LinearAlgebra>
    <QuadratureOrder>6</QuadratureOrder>
    <FiniteElements>
        <VelocityType>CG</VelocityType>
        <PressureType>CG</PressureType>
        <VelocityDegree>2</VelocityDegree>
        <PressureDegree>1</PressureDegree>
        <Numbering>Classic</Numbering> <!-- Classic (use this for ILUPP!), King, CuthillMcKee-->
        <OrderFEbeforeCell>1</OrderFEbeforeCell>
        <UsePressureFilter>0</UsePressureFilter><!-- 0 if outflow is present-->
    </FiniteElements>
    <TimeStepping>
        <T>100.</T>
        <dt>0.1</dt>
        <theta>0.5</theta>
        <SolverType>2</SolverType> <!-- 0: Semi-Linear, 1: Picard, 2: Newton!! -->
        <VisualizationInterval>1</VisualizationInterval>
    </TimeStepping>
    <FlowModel>
        <Density>1.0</Density>
        <Viscosity>1.0e-2</Viscosity>
        <ForceIntegration>Surface</ForceIntegration>
    </FlowModel>
    <NonlinearSolver>
        <MaximumIterations>5</MaximumIterations>
        <AbsoluteTolerance>1.e-15</AbsoluteTolerance>
        <RelativeTolerance>1.e-6</RelativeTolerance>
        <DivergenceLimit>1.e6</DivergenceLimit>
        <ArmijoUpdate>0</ArmijoUpdate>
        <ThetaInitial>0</ThetaInitial>
        <ThetaMinimal>0</ThetaMinimal>
        <ArmijoDecrease>0</ArmijoDecrease>
        <SufficientDecrease>0</SufficientDecrease>
        <MaxArmijoIteration>0</MaxArmijoIteration>
        <ForcingStrategy>EisenstatWalker1</ForcingStrategy>
        <ConstantForcingTerm>1.e-4</ConstantForcingTerm>
        <InitialValueForcingTerm>1.e-3</InitialValueForcingTerm>
        <MaxValueForcingTerm>0.9</MaxValueForcingTerm>
        <GammaParameterEW2>0.9</GammaParameterEW2>
        <AlphaParameterEW2>2</AlphaParameterEW2>
        <PrintLevel>1</PrintLevel>
    </NonlinearSolver>
    <Backup>
        <Restore>0</Restore>
        <LastTimeStep>160</LastTimeStep>
        <Filename>backup.h5</Filename>
    </Backup>
    <LinearSolver>
        <Name>OuterLinSolver</Name>
        <Type>FGMRES</Type>
        <PrecondType>BlockJacobiExt</PrecondType>            <!-- None, Schur (needs LAD=BlockLAD!!!), BlockJacobiStd, BlockJacobiExt , GMG, Vanka, SchwarzSmoother -->
        <MaxIt>500</MaxIt>
        <AbsTol>1.e-20</AbsTol>
        <RelTol>1.e-10</RelTol>
        <DivLimit>1.e6</DivLimit>
        <KrylovSize>500</KrylovSize>
        <ReuseBasis>1</ReuseBasis>
        <UsePrecond>1</UsePrecond>
        <UsePressureFilterOuter>0</UsePressureFilterOuter><!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
        <UsePressureFilter>0</UsePressureFilter>          <!-- Pressure filter within each Krylov iteration -->
        <PrintLevel>0</PrintLevel>
        <Reuse>1</Reuse>
        <UpdateFreqNewton>1</UpdateFreqNewton>             
        <UpdateFreqTime>1</UpdateFreqTime>
    </LinearSolver>
    <GMG>
        <NumLevel>3</NumLevel>                             <!-- has to be equal to refinement_level + 1-->
        <SmootherType>SchwarzSmoother</SmootherType>
        <CycleType>V</CycleType>
        <NumIter>1</NumIter>
        <TransposedP>1</TransposedP>
        <PreSmoothingSteps>2</PreSmoothingSteps>
        <PostSmoothingSteps>2</PostSmoothingSteps>
        <SmootherRelax>0.75</SmootherRelax>
        <NestedIteration>0</NestedIteration>
        <InterpolateRHS>1</InterpolateRHS>
        <SmootherMode>FullResidual</SmootherMode><!-- Note: for PrecondOnly, number of smoothing steps and relax parameter is determined by concrete smoother object-->
        <PrintLevel>0</PrintLevel>
        <CoarseSolver>
            <Name>CoarseSolver</Name>
            <Type>GMRES</Type>
            <PrecondType>SchwarzSmoother</PrecondType>   <!-- BlockJacobiStd, BlockJacobiExt, SchwarzSmoother --> 
            <MaxIt>100</MaxIt>
            <AbsTol>1.e-20</AbsTol>
            <RelTol>1.e-10</RelTol>
            <DivLimit>1.e6</DivLimit>
            <KrylovSize>100</KrylovSize>
            <ReuseBasis>1</ReuseBasis>
            <UsePrecond>1</UsePrecond>
            <UsePressureFilterOuter>0</UsePressureFilterOuter>  <!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
            <UsePressureFilter>0</UsePressureFilter>            <!-- Pressure filter within each Krylov iteration -->
            <PrintLevel>0</PrintLevel>
            <Reuse>1</Reuse>
        </CoarseSolver>
    </GMG>
    <Preconditioner>
        <Method>Preconditioning</Method>
        <Richardson>
            <Damping>0.5</Damping>
            <NumIter>1</NumIter>
            <FixedIter>1</FixedIter>
            <Type>FullResidual</Type> <!-- FullResidual, ApproxResidual, PrecondOnly-->
        </Richardson>
        <SchwarzSmoother>
            <Damping>0.125</Damping>
            <NumIter>1</NumIter>
            <PatchMode>0</PatchMode>  <!-- 0: Single Cell, 1: VertexPatch, 2: EdgePatch, 3: FacetPatch, 4: CellPatch -->
            <SweepMode>0</SweepMode>  <!-- 0: Additive, 1: Multiplicative, 2: Hybrid (locally multiplicative, additive between subprocs)-->
            <LUBlockSize>-1</LUBlockSize>
            <ColoringImpl>DSatur</ColoringImpl><!-- None, DSatur-->
            <RegularizationEps>1e-6</RegularizationEps>
        </SchwarzSmoother>
        <BlockJacobiStd>
            <LocalType>ILU</LocalType> <!-- SSOR, SOR, Jacobi, FSAI, ILU-->
            <SSOR>
                <Omega>1.</Omega>
            </SSOR>
            <SOR>
                <Omega>1.</Omega>
            </SOR>
            <FSAI>
                <NumIter>1000</NumIter>
                <RelRes>1e-10</RelRes>
                <AbsRes>1e-10</AbsRes>
                <Power>1</Power>
            </FSAI>
            <Jacobi>
            </Jacobi>
            <ILU>
                <Bandwidth>2</Bandwidth>
            </ILU>
        </BlockJacobiStd>
        <BlockJacobiExt>
            <LocalType>ILUPP</LocalType> <!-- ILUPP, MklLU, MklILU, UmfpackLU -->
            <MklILU>
                <Bandwidth>1</Bandwidth>
                <RegularizeDiag>1</RegularizeDiag>
                <DiagThreshold>1e-16</DiagThreshold>
                <DiagEps>1e-10</DiagEps>                     
            </MklILU>
            <MklLU>
                <IterativeRefinement>1</IterativeRefinement>
            </MklLU>
            <UmfpackLU>
                <IterativeRefinement>1</IterativeRefinement>
                <PivotTol>0.1</PivotTol>
                <ScaleSum>1</ScaleSum>
                <ScaleMax>0</ScaleMax>
            </UmfpackLU>
            <ILUPP>
                <PreprocessingType>0</PreprocessingType>
                <PreconditionerNumber>11</PreconditionerNumber>
                <MaxMultilevels>20</MaxMultilevels>
                <MemFactor>0.8</MemFactor>
                <PivotThreshold>1.75</PivotThreshold><!-- niedriger -> eher NaN -->
                <MinPivot>0.01</MinPivot>
            </ILUPP>
        </BlockJacobiExt>
        <Vanka>
            <Damping>0.5</Damping>
            <NumIter>1</NumIter>
            <UseILUPP>0</UseILUPP>
            <PrebuildMatrices>1</PrebuildMatrices>
            <PatchMode>0</PatchMode>    <!-- 0: Single Cell, 1: VertexPatch, 2: EdgePatch, 3: FacetPatch, 4: CellPatch -->
            <DoBackwardSweep>0</DoBackwardSweep>
            <LUBlockSize>-1</LUBlockSize>
        </Vanka>
    </Preconditioner>
    <Schur>
        <PrintLevel>0</PrintLevel>
        <OuterSolver>                                   <!-- only relevant if schur is used as smoother in GMG -->
            <Name>Smoother</Name>
            <Type>FGMRES</Type>
            <PrecondType>Schur</PrecondType>            <!-- Schur, BlockJacobiStd, BlockJacobiExt , GMG, (AMG, Richardson), Vanka -->
            <MaxIt>50</MaxIt>
            <AbsTol>1.e-20</AbsTol>
            <RelTol>1.e-10</RelTol>
            <DivLimit>1.e6</DivLimit>
            <KrylovSize>50</KrylovSize>
            <ReuseBasis>1</ReuseBasis>
            <UsePrecond>1</UsePrecond>
            <UsePressureFilterOuter>0</UsePressureFilterOuter><!-- Pressure filter applied to result of linear problem solver (for Newton Method-> other flag is valid)-->
            <UsePressureFilter>0</UsePressureFilter>          <!-- Pressure filter within each Krylov iteration -->
            <PrintLevel>0</PrintLevel>
            <Reuse>1</Reuse>
            <UpdateFreqNewton>1</UpdateFreqNewton>             
            <UpdateFreqTime>1</UpdateFreqTime>
        </OuterSolver>
        <BlockA>
            <Solver>
                <NumIter>1000</NumIter>
                <BasisSize>50</BasisSize>
                <RelativeTolerance>1.e-3</RelativeTolerance>
                <AbsoluteTolerance>0.0</AbsoluteTolerance>
                <ReuseBasis>1</ReuseBasis>
                <PrecondType>AMG</PrecondType><!-- AMG for Hypre LAD-->
            </Solver>
            <AMG>
                <MaxLevels>25</MaxLevels>
                <MaxCoarseSize>9</MaxCoarseSize>
                <CycleType>1</CycleType>
                <InterpType>6</InterpType>
                <CoarsenType>10</CoarsenType>
                <RelaxTypeDown>13</RelaxTypeDown>
                <NumSweepsDown>5</NumSweepsDown>
                <RelaxTypeUp>14</RelaxTypeUp>
                <NumSweepsUp>2</NumSweepsUp>
                <RelaxWt>0.5</RelaxWt>
                <StrongThreshold>0.6</StrongThreshold>
                <AggNumLevels>25</AggNumLevels>
                <AggInterpType>4</AggInterpType>
                <Nodal>0</Nodal>
                <SmoothNumLevels>0</SmoothNumLevels>
                <Variant>3</Variant>
                <Overlap>1</Overlap>
                <DomainType>1</DomainType>
                <SchwarzUseNonSymm>1</SchwarzUseNonSymm>
            </AMG>
        </BlockA>
        <SchurOperator>
            <UseSimpleA>0</UseSimpleA>
            <Solver>
                <NumIter>50</NumIter>
                <RelativeTolerance>5.e-2</RelativeTolerance>
                <AbsoluteTolerance>0.0</AbsoluteTolerance>
                <BasisSize>50</BasisSize>
                <ReuseBasis>1</ReuseBasis>
                <PrintLevel>0</PrintLevel>
            </Solver>
            <Precond>
                <Type>Mass</Type>
                <MassMatrix>
                    <Solver>
                        <NumIter>500</NumIter>
                        <RelativeTolerance>1.e-3</RelativeTolerance>
                        <AbsoluteTolerance>0.0</AbsoluteTolerance>
                        <BasisSize>10</BasisSize>
                        <ReuseBasis>1</ReuseBasis>
                        <PrecondType>AMG</PrecondType><!-- AMG for Hypre LAD-->
                    </Solver>
                    <AMG>
                        <MaxLevels>25</MaxLevels>
                        <MaxCoarseSize>9</MaxCoarseSize>
                        <CycleType>1</CycleType>
                        <RelaxTypeDown>6</RelaxTypeDown>
                        <NumSweepsDown>3</NumSweepsDown>
                        <RelaxTypeUp>6</RelaxTypeUp>
                        <NumSweepsUp>1</NumSweepsUp>
                        <RelaxWt>0.5</RelaxWt>
                        <NumFunctions>1</NumFunctions>
                        <InterpType>6</InterpType>
                        <CoarsenType>10</CoarsenType>
                        <StrongThreshold>0.6</StrongThreshold>
                        <AggNumLevels>25</AggNumLevels>
                        <AggInterpType>4</AggInterpType>
                        <SmoothNumLevels>0</SmoothNumLevels>
                        <Variant>3</Variant>
                        <Overlap>1</Overlap>
                    </AMG>
                </MassMatrix>
                <PCD>
                    <Q>
                        <Solver>
                            <NumIter>500</NumIter>
                            <RelativeTolerance>1.e-3</RelativeTolerance>
                            <AbsoluteTolerance>0.0</AbsoluteTolerance>
                            <BasisSize>10</BasisSize>
                            <ReuseBasis>1</ReuseBasis>
                            <PrecondType>AMG</PrecondType><!-- AMG for Hypre LAD-->
                        </Solver>
                        <AMG>
                            <MaxLevels>25</MaxLevels>
                            <MaxCoarseSize>9</MaxCoarseSize>
                            <CycleType>1</CycleType>
                            <RelaxTypeDown>6</RelaxTypeDown>
                            <NumSweepsDown>3</NumSweepsDown>
                            <RelaxTypeUp>6</RelaxTypeUp>
                            <NumSweepsUp>1</NumSweepsUp>
                            <RelaxWt>0.5</RelaxWt>
                            <NumFunctions>1</NumFunctions>
                            <InterpType>6</InterpType>
                            <CoarsenType>10</CoarsenType>
                            <StrongThreshold>0.6</StrongThreshold>
                            <AggNumLevels>25</AggNumLevels>
                            <AggInterpType>4</AggInterpType>
                            <SmoothNumLevels>0</SmoothNumLevels>
                            <Variant>3</Variant>
                            <Overlap>1</Overlap>
                        </AMG>
                    </Q>
                    <H>
                        <Solver>
                            <NumIter>500</NumIter>
                            <RelativeTolerance>1.e-3</RelativeTolerance>
                            <AbsoluteTolerance>0.0</AbsoluteTolerance>
                            <BasisSize>10</BasisSize>
                            <ReuseBasis>1</ReuseBasis>
                            <PrecondType>AMG</PrecondType><!-- AMG for Hypre LAD-->
                        </Solver>
                        <AMG>
                            <MaxLevels>25</MaxLevels>
                            <MaxCoarseSize>9</MaxCoarseSize>
                            <CycleType>1</CycleType>
                            <RelaxTypeDown>6</RelaxTypeDown>
                            <NumSweepsDown>3</NumSweepsDown>
                            <RelaxTypeUp>6</RelaxTypeUp>
                            <NumSweepsUp>1</NumSweepsUp>
                            <RelaxWt>0.5</RelaxWt>
                            <NumFunctions>1</NumFunctions>
                            <InterpType>6</InterpType>
                            <CoarsenType>10</CoarsenType>
                            <StrongThreshold>0.6</StrongThreshold>
                            <AggNumLevels>25</AggNumLevels>
                            <AggInterpType>4</AggInterpType>
                            <SmoothNumLevels>0</SmoothNumLevels>
                            <Variant>3</Variant>
                            <Overlap>1</Overlap>
                        </AMG>
                    </H>
                </PCD>
            </Precond>
        </SchurOperator>
    </Schur>
</Param>
